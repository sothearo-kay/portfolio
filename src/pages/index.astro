---
import BlogPreview from "~/components/blog/BlogPreview.astro"
import Heading from "~/components/common/Heading.astro"
import Paragraph from "~/components/common/Paragraph.astro"
import Spacer from "~/components/common/Spacer.astro"
import SocialGrid from "~/components/social/SocialGrid.astro"
import TechIcon from "~/components/TechIcon.astro"
import { technologies } from "~/data/technologies"
import MonkeyIllustration from "~/icons/monkey-illustration.svg"
import Layout from "~/layouts/default.astro"
import { getPosts } from "~/utils/blog"

const allBlogPosts = await getPosts()
const latestPosts = allBlogPosts.slice(0, 2).map(post => ({
  id: post.id,
  title: post.data.title,
  description: post.data.description,
}))
---

<Layout title="Homepage" description="Frontend Developer based in Phnom Penh crafting beautiful web experiences. Code by day, manga by night.">
  <section class="hero">
    <div class="content">
      <div class="text">
        <Heading as="h1" size="3xl" class="heading">Hello, I'm Sothearo.</Heading>
        <Paragraph>
          I'm a <strong>Frontend Developer</strong> based in Phnom Penh who loves
          building beautiful, functional web experiences.
        </Paragraph>
        <Paragraph>
          Code by day, manga by night. Always excited about
          <strong>creating something amazing</strong>.
        </Paragraph>
      </div>

      <div class="image">
        <MonkeyIllustration class="illustration" />
      </div>
    </div>
  </section>

  <section>
    <Spacer pattern />
    <SocialGrid />
    <Spacer pattern />
  </section>

  <section class="about">
    <Heading as="h2" size="2xl" class="heading">About Me</Heading>
    <div class="content">
      <Paragraph>
        Hi! I'm <strong>Sothearo</strong>, a Frontend Developer based in Phnom Penh, Cambodia.
        I enjoy turning ideas into clean, user-friendly web experiences — from sleek UI design to smooth
        interactions that make a site feel alive.
      </Paragraph>

      <Paragraph>
        My work is fueled by curiosity and creativity. I'm always exploring better ways to build for the web,
        learning modern frameworks, and pushing myself to write code that's both elegant and practical.
      </Paragraph>

      <Paragraph>
        Outside of coding, I dive deep into the world of manga and storytelling.
        <strong>Code by day, manga by night.</strong> Stories inspire me — whether they're written in panels
        or in lines of code.
        If you're curious, here are some of my <a href="/manga" class="link">favorites</a>.
      </Paragraph>
    </div>
  </section>

  <Spacer pattern />

  <section class="technologies">
    <Heading as="h2" size="2xl" class="heading">Technologies</Heading>
    <div class="grid">
      {technologies.map(tech => (
        <TechIcon name={tech.name} label={tech.label} />
      ))}
    </div>
  </section>

  <Spacer pattern />

  <section class="latest-blogs">
    <div class="header">
      <Heading as="h2" size="2xl" class="heading">Latest Blogs</Heading>
      <a href="/blog" class="link">
        View all posts
      </a>
    </div>
    <div class="blogs">
      {latestPosts.map(post => <BlogPreview {...post} />)}
    </div>
  </section>
</Layout>

<style>
  section {
    --section-spacing: calc(var(--block-spacing) * 0.75);
  }

  .hero {
    padding-bottom: 0;

    .content {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 2rem;
      align-items: center;

      & :global(.heading) {
        margin-bottom: calc(var(--block-spacing) * 0.5);
      }
    }


    .illustration {
      width: 100%;
      max-width: 400px;
      height: auto;
    }
  }

  .about {
    & :global(.heading) {
      margin-bottom: var(--section-spacing);
    }

    .content {
      display: flex;
      flex-direction: column;
      gap: 1.25rem;

      p {
        margin-block: 0;
      }
    }
  }

  .technologies {
    & :global(.heading) {
      margin-bottom: var(--section-spacing);
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(40px, 1fr));
      gap: 1rem;
      justify-items: center;
    }
  }

  .latest-blogs {
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: var(--block-spacing);

      & :global(.heading) {
        margin-block: 0;
      }

      & .link {
        font: var(--font-md);
        font-weight: 500;
      }
    }

    .blogs {
      display: flex;
      flex-direction: column;
      gap: 1.25rem;
    }
  }

  @media (max-width: 768px) {
    .hero {
      padding-block: 2rem;

      .content {
        grid-template-columns: 1fr;
        text-align: center;
        gap: 0;
      }

      .image {
        grid-row-start: 1;
      }

      .illustration {
        max-width: 280px;
      }
    }
  }
</style>
