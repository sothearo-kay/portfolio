---
import Separator from "../common/Separator.astro"
import ThemeToggle from "../ThemeToggle.astro"

const navItems = [
  { href: "/", text: "Home" },
  { href: "/blog", text: "Blog" },
  { href: "/projects", text: "Projects" },
  { href: "/about", text: "About" },
]

const currentPath = new URL(Astro.request.url).pathname

function isActive(href: string) {
  const normalizedCurrent = currentPath === "/" ? "/" : currentPath.replace(/\/$/, "")
  const normalizedHref = href === "/" ? "/" : href.replace(/\/$/, "")
  return normalizedCurrent === normalizedHref
}
---

<header class="header">
  <div class="wrapper" transition:name="header-wrapper">
    <nav class="nav">
      <ul class="nav-list">
        {navItems.map(item => (
          <li class="nav-item">
            <a href={item.href} class:list={["nav-link", { active: isActive(item.href) }]}>
              {item.text}
            </a>
          </li>
        ))}
      </ul>
    </nav>

    <Separator orientation="vertical" />
    <ThemeToggle />
  </div>
</header>

<style>
  .header {
    z-index: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    position: fixed;
    top: 1rem;
    left: 50%;
    transform: translateX(-50%);

    .wrapper {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 1rem;
      padding-block: 0.5rem;
      padding-inline: 1rem;
      border-radius: 999px;
      background-color: var(--color-background-elevated-transparent);
      border: 1px solid var(--color-border-subtle);
      box-shadow: var(--shadow-header);
      backdrop-filter: blur(0);
    }

    .nav-list {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 1rem;
    }

    .nav-item {
      font-size: 14px;
      font-weight: 500;

      .nav-link {
        padding: 0.5rem;
        color: var(--color-accent-foreground);
        transition: color 0.2s ease;

        &:hover,
        &.active {
          color: var(--color-foreground);
        }
      }
    }
  }
</style>
