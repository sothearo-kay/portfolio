---
import type { Project } from "~/data/projects"
import { Picture } from "astro:assets"
import ArrowUpRightIcon from "~/icons/arrow/arrow-up-right.svg"
import Heading from "../common/Heading.astro"
import Paragraph from "../common/Paragraph.astro"
import WithPlaceholder from "../common/WithPlaceholder.astro"

interface Props {
  project: Project
}

const { project } = Astro.props
const { title, description, previewUrl, githubUrl } = project

const url = previewUrl || githubUrl
const imageUrl = `https://assets.sothearo.dev/images/projects/${title.toLowerCase()}/preview.png`
const darkImageUrl = `https://assets.sothearo.dev/images/projects/${title.toLowerCase()}/preview-dark.png`
---

<a href={url} target="_blank" rel="noopener noreferrer" class="card">
  <WithPlaceholder src={imageUrl} class="image-wrapper light">
    <Picture
      src={imageUrl}
      alt={title}
      width={600}
      height={400}
      widths={[600, 1200]}
      formats={["avif", "webp"]}
      class="image"
    />
  </WithPlaceholder>
  <WithPlaceholder src={darkImageUrl} class="image-wrapper dark">
    <Picture
      src={darkImageUrl}
      alt={title}
      width={600}
      height={400}
      widths={[600, 1200]}
      formats={["avif", "webp"]}
      class="image"
    />
  </WithPlaceholder>

  <div class="content">
    <Heading as="h3" size="lg" reset class="title">
      {title}
      <ArrowUpRightIcon class="arrow" />
    </Heading>

    <Paragraph size="sm" secondary reset lineClamp={3}>
      {description}
    </Paragraph>
  </div>
</a>

<style>
  .card {
    display: flex;
    flex-direction: column;
    gap: 1rem;

    .content {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }

    :global(.title) {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 0.375rem;

      .arrow {
        width: 1rem;
        height: 1rem;
        color: var(--color-foreground-muted);
        transition-property: color, transform;
        transition-duration: 0.2s;
        transition-timing-function: ease;
      }
    }

    @media (hover: hover) {
      &:hover {
        :global(.title) {
          text-decoration: underline;
          text-underline-offset: 3px;
        }

        .arrow {
          color: var(--color-foreground);
          transform: translateX(2px) translateY(-2px);
        }
      }
    }
  }

  :global(.image-wrapper) {
    border-radius: 6px;
    box-shadow: var(--shadow-card);

    &.light {
      display: block;
    }

    &.dark {
      display: none;
    }

    .image {
      border-radius: 6px;
      aspect-ratio: 16 / 9;
    }
  }

  :global([data-theme="dark"] .image-wrapper) {
    &.light {
      display: none;
    }

    &.dark {
      display: block;
    }
  }
</style>
